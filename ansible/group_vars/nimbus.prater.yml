---
# Not pretty but avoids useless files
node_size: |-
  {{ (hostname is search("large")) | ternary("large", "small") }}
node_branch: |-
  {{ (hostname is search("unstable")) | ternary("unstable", (
     (hostname is search("testing")) | ternary("testing", (
     (hostname is search("stable")) | ternary("stable", (
     (hostname is search("libp2p")) | ternary("libp2p", "UNKNOWN")
  )))))) }}

beacon_node_cont_tag: '{{ node_branch }}-{{ node_size }}'
beacon_node_network: 'prater'

# Windows service user
beacon_node_service_user_pass: '{{lookup("bitwarden", "nimbus/windows", field="password")}}'

# Split by hostname for more central location
validators_layout:
  # 2500 validators per node
  'stable-large-01.aws-eu-central-1a.nimbus.prater':     { start:     0, end:  2500 }
  'stable-large-02.aws-eu-central-1a.nimbus.prater':     { start:  2500, end:  5000 }
  'stable-large-03.aws-eu-central-1a.nimbus.prater':     { start:  5000, end:  7500 }
  # 2500 validators per node
  'testing-large-01.aws-eu-central-1a.nimbus.prater':    { start: 12500, end: 15000 }
  'testing-large-02.aws-eu-central-1a.nimbus.prater':    { start: 15000, end: 17500 }
  'testing-large-03.aws-eu-central-1a.nimbus.prater':    { start: 17500, end: 20000 }
  # 2500 validators per node
  "unstable-large-01.aws-eu-central-1a.nimbus.prater":   { start: 25000, end: 27500 }
  "unstable-large-02.aws-eu-central-1a.nimbus.prater":   { start: 27500, end: 30000 }
  "unstable-large-03.aws-eu-central-1a.nimbus.prater":   { start: 30000, end: 32500 }
  # 1250 validators per node
  'u-libp2p-s-large-01.aws-eu-central-1a.nimbus.prater': { start: 37500, end: 38750 }
  # 1250 validators per node
  'u-libp2p-u-large-01.aws-eu-central-1a.nimbus.prater': { start: 38750, end: 40000 }

# Copy correct validators from nimbus-private repo
beacon_node_dist_validators_enabled: true
beacon_node_dist_validators_start: '{{ validators_layout[hostname]["start"] | mandatory }}'
beacon_node_dist_validators_end: '{{ validators_layout[hostname]["end"] | mandatory }}'
